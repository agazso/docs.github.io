<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><title>Development - Swarm Bee Documentation</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=../favicon.png><link rel=stylesheet href=../css/style.min.aad43d4ecb69a264f2539b89d7f779d5f3cdff22e7585fe5fc3c77272f1c2696.css></head><body class="page page-default-single"><div id=main-menu-mobile class=main-menu-mobile><ul></ul></div><div class=wrapper><div class=header><div class=container><div class=logo><a href=../><img alt=Logo src=../swarm.png></a></div><div class=logo-mobile><a href=../><img alt=Logo src=../swarm.png></a></div><div id=main-menu class=main-menu><ul></ul></div><button id=toggle-main-menu-mobile class="hamburger hamburger--slider" type=button>
<span class=hamburger-box><span class=hamburger-inner></span></span></button></div></div><div class="container pt-2 pt-md-6 pb-3 pb-md-6"><div class=row><div class="col-12 col-md-3 mb-3"><div class=sidebar><div class=docs-menu><h4>Bee docs</h4><ul><li><a href=../bee-docs/introduction.html>Introduction</a></li><li><a href=../bee-docs/installation.html>Installation</a></li><li><a href=../bee-docs/start.html>Starting your node</a></li><li><a href=../bee-docs/tutorial.html>Tutorial</a></li><li class=active><a href=../bee-docs/development.html>Development</a></li><li><a href=../bee-docs/API-reference.html>API and debug API</a></li><li><a href=../bee-docs/architecture.html>Architecture</a></li></ul></div></div></div><div class="col-12 col-md-9"><h1 class=title>Development</h1><div class=content><p>Installation from source is described in the <a href=%22/bee-docs/installation.html%22>Installation</a>.</p><h2 id=starting-more-bee-nodes-locally-with-debugging>Starting more bee nodes locally with debugging</h2><p>It is possible to start multiple, persistent, completely independent, Bee nodes on a single running operating system. This can be achieved with less complexity with prepared configuration files for every node.</p><p>An example configuration for the first node would be:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=k>api-addr</span><span class=p>:</span><span class=w> </span><span class=p>:</span><span class=m>8081</span><span class=w>
</span><span class=w></span><span class=k>p2p-addr</span><span class=p>:</span><span class=w> </span><span class=p>:</span><span class=m>7071</span><span class=w>
</span><span class=w></span><span class=k>debug-api-addr</span><span class=p>:</span><span class=w> </span><span class=m>127.0.0.1</span><span class=p>:</span><span class=m>6061</span><span class=w>
</span><span class=w></span><span class=k>enable-debug-api</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w></span><span class=k>data-dir</span><span class=p>:</span><span class=w> </span>/tmp/bee/node1<span class=w>
</span><span class=w></span><span class=k>password</span><span class=p>:</span><span class=w> </span>some<span class=w> </span>pass<span class=w> </span>phze<span class=w>
</span><span class=w></span><span class=k>verbosity</span><span class=p>:</span><span class=w> </span>trace<span class=w>
</span><span class=w></span><span class=k>tracing</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></code></pre></div><p>Save a file named <code>node1.yaml</code> with this content, and create as many as you need by incrementing the number in in filename and <code>api-addr</code>, <code>p2p-addr</code>, <code>debug-api-addr</code> and <code>data-dir</code>.</p><p>For example, file <code>node2.yaml</code> should have this content:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=k>api-addr</span><span class=p>:</span><span class=w> </span><span class=p>:</span><span class=m>8082</span><span class=w>
</span><span class=w></span><span class=k>p2p-addr</span><span class=p>:</span><span class=w> </span><span class=p>:</span><span class=m>7072</span><span class=w>
</span><span class=w></span><span class=k>debug-api-addr</span><span class=p>:</span><span class=w> </span><span class=m>127.0.0.1</span><span class=p>:</span><span class=m>6062</span><span class=w>
</span><span class=w></span><span class=k>enable-debug-api</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w></span><span class=k>data-dir</span><span class=p>:</span><span class=w> </span>/tmp/bee/node2<span class=w>
</span><span class=w></span><span class=k>password</span><span class=p>:</span><span class=w> </span>some<span class=w> </span>pass<span class=w> </span>phze<span class=w>
</span><span class=w></span><span class=k>verbosity</span><span class=p>:</span><span class=w> </span>trace<span class=w>
</span><span class=w></span><span class=k>tracing</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></code></pre></div><h3 id=starting-the-first-node>Starting the first node</h3><p>The first node address will be used for other nodes to discover themselves. It is usually referred as the <code>bootnode address</code>.</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>bee --config node1.yaml start
</code></pre></div><p>When the node starts it will print out some of its <code>p2p addresses</code> in a multiaddress form like this: <code>/ip4/127.0.0.1/tcp/7071/p2p/16Uiu2HAm2LXfYsY9pXtgGdQ8oPb3bAkxwpfBE6AMzcscH1UkQLZM</code>. This address is the <code>bootnonde address</code>.</p><h3 id=starting-other-nodes>Starting other nodes</h3><p>Other nodes should be started by providing the bootnode address to them, so that they can connect to each other:</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>bee --config node2.yaml start --bootnode /ip4/127.0.0.1/tcp/7071/p2p/16Uiu2HAm2LXfYsY9pXtgGdQ8oPb3bAkxwpfBE6AMzcscH1UkQLZM
bee --config node3.yaml start --bootnode /ip4/127.0.0.1/tcp/7071/p2p/16Uiu2HAm2LXfYsY9pXtgGdQ8oPb3bAkxwpfBE6AMzcscH1UkQLZM
bee --config node4.yaml start --bootnode /ip4/127.0.0.1/tcp/7071/p2p/16Uiu2HAm2LXfYsY9pXtgGdQ8oPb3bAkxwpfBE6AMzcscH1UkQLZM
...
</code></pre></div><h2 id=getting-node-addresses>Getting node addresses</h2><p>Debug API is not started by default and has to be explicitly enabled by using configuration YAML files or with <code>--enable-debug-api --debug-api-addr 127.0.0.1:6061</code> command line flags or options.</p><p>Every node can provide its overlay address and underlay addresses by reading the logs when the node starts or through Debug API. For example, for the node 1 started with configuration above:</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>curl localhost:6061/addresses
</code></pre></div><p>It will return a response with addresses:</p><div class=highlight><pre class=chroma><code class=language-json data-lang=json><span class=p>{</span>
  <span class=nt>&#34;overlay&#34;</span><span class=p>:</span> <span class=s2>&#34;7ecf777fdab7553fbc4db7f265a7bd80d27b171babe931bc61e9d7966974ef47&#34;</span><span class=p>,</span>
  <span class=nt>&#34;underlay&#34;</span><span class=p>:</span> <span class=p>[</span>
    <span class=s2>&#34;/ip6/::1/udp/7071/quic/p2p/16Uiu2HAm2LXfYsY9pXtgGdQ8oPb3bAkxwpfBE6AMzcscH1UkQLZM&#34;</span><span class=p>,</span>
    <span class=s2>&#34;/ip4/127.0.0.1/tcp/7071/p2p/16Uiu2HAm2LXfYsY9pXtgGdQ8oPb3bAkxwpfBE6AMzcscH1UkQLZM&#34;</span><span class=p>,</span>
    <span class=s2>&#34;/ip4/127.0.0.1/udp/7071/quic/p2p/16Uiu2HAm2LXfYsY9pXtgGdQ8oPb3bAkxwpfBE6AMzcscH1UkQLZM&#34;</span><span class=p>,</span>
    <span class=s2>&#34;/ip6/::1/tcp/7071/p2p/16Uiu2HAm2LXfYsY9pXtgGdQ8oPb3bAkxwpfBE6AMzcscH1UkQLZM&#34;</span><span class=p>,</span>
  <span class=p>]</span>
<span class=p>}</span>
</code></pre></div><h2 id=testing-a-connection-with-pingpong-protocol>Testing a connection with PingPong protocol</h2><p>To check if two nodes are connected and to see the round trip time for message exchange between them, get the overlay address from one node, for example local node 2:</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>curl localhost:6062/addresses
</code></pre></div><p>Make sure that Debug API is enabled and address configured as in examples above.</p><p>And use that address in the Debug API call on another node, for example, local node 1:</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>curl -XPOST localhost:6061/pingpong/d4440baf2d79e481c3c6fd93a2014d2e6fe0386418829439f26d13a8253d04f1
</code></pre></div><h2 id=generating-protobuf>Generating protobuf</h2><p>To process protocol buffer files and generate the Go code from it two tools are needed:</p><ul><li>protoc - <a href=https://github.com/protocolbuffers/protobuf/releases>https://github.com/protocolbuffers/protobuf/releases</a></li><li>protoc-gen-gogofaster - <a href=https://github.com/gogo/protobuf>https://github.com/gogo/protobuf</a></li></ul><p>Makefile rule <code>protobuf</code> can be used to automate <code>protoc-gen-gogofaster</code> installation and code generation:</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>make protobuf
</code></pre></div></div></div></div></div></div></div><div class=sub-footer><div class=container><div class=row><div class=col-12><div class=sub-footer-inner><ul><li class=zerostatic><a href=https://swarm-gateways.net/bzz:/docs.swarm.eth/>docs.swarm.eth</a></li></ul></div></div></div></div></div><script type=text/javascript src=../js/scripts.min.1237ff71925bb8625c97a9af8db4c54525258bedfd7c47493daaff723bea755e.js></script></body></html>